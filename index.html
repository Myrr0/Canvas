<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fabric.js Canvas</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
  <style>
    body {
      display: flex;
      margin: 0;
      background-color: #f0f0f0;
    }
    #sidebar {
      width: 200px;
      padding: 20px;
      box-sizing: border-box;
      background-color: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #canvasContainer {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
      border: 1px solid #000;
    }
    #textEdit, #updateText, #addTextButton, #shapeSelect {
      display: block;
      margin: 10px 0;
      width: 100%;
    }
    #contextMenu ul li {
      cursor: pointer;
      padding: 5px 10px;
    }
    #contextMenu ul li:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <select id="shapeSelect">
      <option value="">Choose Shape</option>
      <option value="circle">Circle</option>
      <option value="square">Square</option>
      <option value="star">Star</option>
    </select>
    <button id="addTextButton">Add Text</button>
    <div id="contextMenu" style="display: none; position: absolute; background: white; border: 1px solid #ccc; padding: 10px;">
      <ul style="list-style: none; padding: 0; margin: 0;">
        <li id="deleteOption">Delete</li>
      </ul>
    </div>
  </div>
  <div id="canvasContainer">
    <canvas id="c" width="800" height="600"></canvas>
  </div>
  <script>
  document.addEventListener('contextmenu', function(event) {
    event.preventDefault();
  });
  // Initialize fabric.js canvas
  var canvas = new fabric.Canvas('c');
  console.log('Canvas initialized:', canvas);

  // Initialize fabric.js canvas
  var canvas = new fabric.Canvas('c');
  console.log('Canvas initialized:', canvas);

  // Add a new text object to the canvas
  var initialText = new fabric.Text('Editable Text', {
    left: 150,
    top: 150,
    fontSize: 30,
    fontFamily: 'Arial',
    editable: true
  });
  canvas.add(initialText);

  // Add text to canvas when button is clicked
  document.getElementById('addTextButton').addEventListener('click', function() {
    var newText = new fabric.Text('New Text', {
      left: 150,
      top: 150,
      fontSize: 30,
      fontFamily: 'Arial'
    });
    canvas.add(newText);
    canvas.setActiveObject(newText); // Ensure new text is selectable
  });
  // Function to add shapes to the canvas
  function addShape(shape) {
    let newShape;
    switch(shape) {
      case 'circle':
        newShape = new fabric.Circle({
          radius: 50,
          fill: 'blue',
          left: 200,
          top: 200
        });
        break;
      case 'square':
        newShape = a fabric.Rect({
          width: 100,
          height: 100,
          fill: 'green',
          left: 300,
          top: 200
        });
        break;
      case 'star':
        var points = [
          {x: 50, y: 0},
          {x: 61, y: 35},
          {x: 98, y: 35},
          {x: 68, y: 57},
          {x: 79, y: 91},
          {x: 50, y: 70},
          {x: 21, y: 91},
          {x: 32, y: 57},
          {x: 2, y: 35},
          {x: 39, y: 35}
        ];
        newShape = new fabric.Polygon(points, {
          fill: 'yellow',
          left: 400,
          top: 200
        });
        break;
      default:
        return;
    }
    canvas.add(newShape);
  }

  // Event listener for shape selection
  document.getElementById('shapeSelect').addEventListener('change', function() {
    var selectedShape = this.value;
    if (selectedShape) {
      addShape(selectedShape);
    }
  });
  // Add event listener for right-click (context menu) on canvas objects
  canvas.on('mouse:down', function(event) {
    if (event.e.button === 2) { // Right-click
      var activeObject = event.target;
      if (activeObject) {
        showContextMenu(event.e.clientX, event.e.clientY, activeObject);
      }
    }
  });

  // Function to show context menu
  function showContextMenu(x, y, object) {
    var contextMenu = document.getElementById('contextMenu');
    contextMenu.style.left = x + 'px';
    contextMenu.style.top = y + 'px';
    contextMenu.style.display = 'block';

    // Add event listener for deleting the object
    document.getElementById('deleteOption').onclick = function() {
      console.log('Deleting object:', object);
      canvas.remove(object);
      canvas.renderAll(); // Render the canvas to see the changes
      contextMenu.style.display = 'none'; // Hide the context menu
    };

    // Hide context menu when clicking outside
    document.addEventListener('click', function() {
      contextMenu.style.display = 'none';
    }, { once: true });
  }
</script>
</body>
</html>

